<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | UnknownScripts</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
    <style>
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 8px;
            transition: var(--transition-fast);
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
        }
    </style>
</head>

<body>
    <!-- Background Effects -->
    <div class="bg-grid"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container navbar-content" style="max-width: 100%; padding: 0 32px;">
            <a href="index.html" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-shield-halved"></i>
                </div>
                <div class="logo-text">Unknown<span>Scripts</span></div>
            </a>
            <div class="nav-actions">
                <span style="color: var(--text-muted); font-size: 0.9rem; margin-right: 8px;">
                    <i class="fas fa-user-circle"></i> Admin
                </span>
                <button onclick="logout()" class="btn btn-outline btn-sm">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </button>
            </div>
        </div>
    </nav>

    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-label">Main</div>
                <a href="#" class="sidebar-link active" data-view="dashboard">
                    <i class="fas fa-home"></i>
                    Dashboard
                </a>
                <a href="#" class="sidebar-link" data-view="scripts">
                    <i class="fas fa-code"></i>
                    My Scripts
                </a>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-label">Management</div>
                <a href="#" class="sidebar-link" data-view="users">
                    <i class="fas fa-users"></i>
                    Keys & Users
                </a>
                <a href="#" class="sidebar-link" data-view="settings">
                    <i class="fas fa-cog"></i>
                    Settings
                </a>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Dashboard View -->
            <div id="view-dashboard" class="view active">
                <h2 style="margin-bottom: 24px; font-size: 1.5rem;">Overview</h2>

                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>Total Executions</h4>
                        <div class="stat-value" id="statExecutions">0</div>
                    </div>
                    <div class="stat-card">
                        <h4>Active Keys</h4>
                        <div class="stat-value accent" id="statKeys">0</div>
                    </div>
                    <div class="stat-card">
                        <h4>Protected Scripts</h4>
                        <div class="stat-value" id="statScripts">0</div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-shield-alt" style="margin-right: 8px; color: var(--accent-secondary);"></i>
                            Quick Protect</h3>
                    </div>
                    <div class="panel-body">
                        <p style="color: var(--text-secondary); margin-bottom: 16px;">Paste your Lua script below to
                            obfuscate and protect it.</p>

                        <textarea id="scriptInput"
                            placeholder="-- Paste your script here&#10;print('Hello World')"></textarea>

                        <div style="display: flex; gap: 12px; margin-top: 16px; flex-wrap: wrap;">
                            <button onclick="obfuscateScript()" class="btn btn-primary">
                                <i class="fas fa-lock"></i>
                                Protect Script
                            </button>
                            <button onclick="copyOutput()" class="btn btn-outline" id="copyBtn" style="display: none;">
                                <i class="fas fa-copy"></i>
                                Copy
                            </button>
                            <button onclick="downloadOutput()" class="btn btn-outline" id="downloadBtn"
                                style="display: none;">
                                <i class="fas fa-download"></i>
                                Download
                            </button>
                            <button onclick="saveCurrentAsScript()" class="btn btn-outline" id="saveBtn"
                                style="display: none;">
                                <i class="fas fa-save"></i>
                                Save to My Scripts
                            </button>
                        </div>

                        <!-- Output Section -->
                        <div id="outputArea" class="output-section" style="display: none;">
                            <h4><i class="fas fa-file-code" style="margin-right: 8px;"></i> Step 1: Protected Output
                            </h4>
                            <p>Copy this code and paste it into a <strong>Secret Gist</strong> on GitHub. Then click
                                "Raw" to get the URL.</p>
                            <textarea id="scriptOutput" class="output-textarea" readonly
                                style="min-height: 120px;"></textarea>

                            <div style="margin-top: 24px;">
                                <h4><i class="fas fa-link" style="margin-right: 8px;"></i> Step 2: Generate Loader</h4>
                                <p>Paste the <strong>Raw Gist URL</strong> below to generate your loadstring.</p>
                                <div class="input-group" style="margin-top: 12px;">
                                    <input type="text" id="rawLinkInput"
                                        placeholder="https://gist.githubusercontent.com/...">
                                    <button onclick="createLoader()" class="btn btn-primary">
                                        <i class="fas fa-wand-magic-sparkles"></i>
                                        Generate
                                    </button>
                                </div>
                            </div>

                            <div id="finalLoaderArea" style="margin-top: 16px; display: none;">
                                <h4><i class="fas fa-check-circle" style="margin-right: 8px; color: #22c55e;"></i> Your
                                    Loadstring</h4>
                                <textarea id="finalLoader" class="output-success" readonly
                                    style="min-height: 80px;"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scripts View -->
            <div id="view-scripts" class="view">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                    <h2 style="font-size: 1.5rem;">My Scripts</h2>
                    <button class="btn btn-primary btn-sm" onclick="switchView('dashboard')">
                        <i class="fas fa-plus"></i>
                        New Script
                    </button>
                </div>

                <div class="panel">
                    <div class="panel-body" style="padding: 0;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <th
                                        style="text-align: left; padding: 16px 24px; color: var(--text-muted); font-weight: 500; font-size: 0.85rem;">
                                        Name</th>
                                    <th
                                        style="text-align: left; padding: 16px 24px; color: var(--text-muted); font-weight: 500; font-size: 0.85rem;">
                                        Version</th>
                                    <th
                                        style="text-align: left; padding: 16px 24px; color: var(--text-muted); font-weight: 500; font-size: 0.85rem;">
                                        Status</th>
                                    <th
                                        style="text-align: right; padding: 16px 24px; color: var(--text-muted); font-weight: 500; font-size: 0.85rem;">
                                        Actions</th>
                                </tr>
                            </thead>
                            <tbody id="scriptTableBody">
                                <!-- Scripts rendered by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Users View -->
            <div id="view-users" class="view">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                    <h2 style="font-size: 1.5rem;">Keys & Users</h2>
                    <button onclick="generateKey()" class="btn btn-primary btn-sm">
                        <i class="fas fa-plus"></i>
                        Generate Key
                    </button>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h3>Generated Keys</h3>
                    </div>
                    <div class="panel-body" id="keyList">
                        <!-- Keys rendered by JS -->
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="view-settings" class="view">
                <h2 style="margin-bottom: 24px; font-size: 1.5rem;">Settings</h2>
                <div class="panel">
                    <div class="panel-body">
                        <p style="color: var(--text-secondary); margin-bottom: 16px;">
                            <i class="fas fa-info-circle" style="margin-right: 8px;"></i>
                            This is a static site. Data is stored in your browser's local storage.
                        </p>
                        <button
                            onclick="if(confirm('Are you sure? This will delete all scripts and keys!')) { localStorage.clear(); location.reload(); }"
                            class="btn btn-outline" style="border-color: #ef4444; color: #ef4444;">
                            <i class="fas fa-trash"></i>
                            Clear All Data
                        </button>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Edit Script Modal -->
    <div id="editScriptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit" style="margin-right: 8px;"></i> Edit Script</h3>
                <button class="modal-close" onclick="closeEditModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="editScriptName">Script Name</label>
                    <input type="text" id="editScriptName" placeholder="My Awesome Script">
                </div>
                <div class="form-group">
                    <label for="editScriptGist">Raw Gist URL</label>
                    <input type="text" id="editScriptGist" placeholder="https://gist.githubusercontent.com/...">
                </div>
                <div class="form-group">
                    <label for="editScriptCode">Protected Code</label>
                    <textarea id="editScriptCode" style="min-height: 200px;"
                        placeholder="-- Protected code here"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeEditModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveEditedScript()">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <script src="assets/js/main.js"></script>
    <script>
        // Show save button when output is visible
        const observer = new MutationObserver(() => {
            const outputArea = document.getElementById('outputArea');
            const saveBtn = document.getElementById('saveBtn');
            if (outputArea && saveBtn) {
                saveBtn.style.display = outputArea.style.display === 'none' ? 'none' : 'inline-flex';
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const outputArea = document.getElementById('outputArea');
            if (outputArea) {
                observer.observe(outputArea, { attributes: true, attributeFilter: ['style'] });
            }
        });
    </script>
</body>

</html>